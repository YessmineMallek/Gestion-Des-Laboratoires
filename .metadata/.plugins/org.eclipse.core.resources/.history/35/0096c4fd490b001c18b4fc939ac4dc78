package GestionLabo.service;

import java.util.Iterator;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import GestionLabo.model.Laboratoire;
import GestionLabo.repository.LaboratoireRepository;
import lombok.Data;

@Data
@Service
public class LaboratoireService {
	@Autowired
	private LaboratoireRepository laboRep;
	
	
	
	//afficher tous les laboratoires
	public Iterable<Laboratoire> getAllLabo()
	{
		Iterator<Laboratoire> itLab=laboRep.findAll().iterator();
		
		return laboRep.findAll();
	}
	
	//ajouter une laboratoire a la base de donn√©e
	
	public Laboratoire addLabo (Laboratoire labToAdd)
	{
		Laboratoire lab=null;
		try
		{
			lab= laboRep.save(labToAdd);

		}catch (Exception ex )
		{
			if (ex instanceof java.sql.SQLIntegrityConstraintViolationException || ex instanceof  o.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m )
			{	
				System.out.println("existe deja");
				return null;
			}
		
		}
		return lab;
		
	}
		
	
	
	//mise a jour
	
	  public Laboratoire update (Laboratoire labDonn√© , int code) {
	  
		  
		  
	Iterable<Laboratoire> lesLabs=this.getAllLabo(); Iterator<Laboratoire>
	  it=lesLabs.iterator(); 
		Laboratoire lab = null;
	  
	  while(it.hasNext()) {
				  lab=it.next(); 
				  
				  if(lab.getCode()==code) 
				  {
				  
				  lab.setType(labDonn√©.getType());
				  
				  lab.setDenomination(labDonn√©.getDenomination()) ;
				  lab.setNomCompletEnArabe(labDonn√©.getNomCompletEnArabe());
				  lab.setNomCompletEnAnglais(labDonn√©.getNomCompletEnAnglais());
				  lab.setAcronyme(labDonn√©.getAcronyme());
				  lab.setDateCreation(labDonn√©.getDateCreation());
				  lab.setUniversite(labDonn√©.getUniversite());
				  lab.setInstitution(labDonn√©.getInstitution());
				  lab.setDomaine(labDonn√©.getDomaine());
				  lab.setDiscipline(labDonn√©.getDiscipline());
				  lab.setSpecialite(labDonn√©.getSpecialite());
				  lab.setSiteWeb(labDonn√©.getSiteWeb()); 
				  lab.setTelephone(labDonn√©.getTelephone());
				  lab.setFax(labDonn√©.getFax());
				  lab.setAdresseOfficielle(labDonn√©.getAdresseOfficielle()); 
				  return  this.laboRep.save(lab);
				  } 
	  }
	  return null;
	  }	 
	
	//supprimer la laboratoire
	
	public void delete(String code)
	{
		 laboRep.deleteById(code);
	}
	
	
	//findByCode
	public  Laboratoire fingByCode(int code)
	{
		Iterator<Laboratoire> labIt=this.getAllLabo().iterator();
		while (labIt.hasNext())
		{
			Laboratoire l=labIt.next();
			if(l.getCode()==code)
				return l;
		}
	return null;
	}
	
	
}
